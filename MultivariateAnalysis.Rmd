---
title: "MA Analysis"
output:
  html_document:
    df_print: paged
---

This is a snippet of Principal Component Analysis (PCA) on the 'mtcars' sample dataset. 
```{r}
# Preview of mtcars dataset
head(mtcars)
``` 

For this analysis, the columns to be used are:

mpg - Miles per gallon (US) used by the car.

disp -  Displacement in cubic in., the combined volume of the engine's cylinders.

hp - Gross horsepower, the power generated by the car.

drat - Rear axle ratio, how a turn of the drive shaft corresponds to a turn of the wheels.

wt - Weight, in 1000 lbs.

qsec - 1/4 mile time, the acceleration and speed needed to complete 1/4th of a mile

```{r}
# Extracting only the required columns.
cars_data = mtcars[,c(1,3:7)]
cars_data
```
```{r}
# Preliminary view of pairwise relationship between variables
pairs(cars_data) 

pcor = round(cor(cars_data), digits=3)
pcor
```

Proceed with Principal Component Analysis (PCA).

Why PCA? 
PCA reduces the dimensionality of the dataset to make it easier to spot trends within the variables. With a simple dataset of two variables, it is easy to spot them using simple measurements like correlation, but with a multivariate dataset the variables need to be transformed in order to spot patterns in terms of variation between the data in the dataset. 

```{r}
# prcomp: Performs a principal components analysis on the given data matrix.
cars_prcomp = prcomp(cars_data, scale = TRUE) 
cars_prcomp
```

Scree plot

Scree plots are then used to determine the proportion of variance explained with each additional principal component.
This will help to choose the number of principal components to retain.

```{r}
# variances of the principal components
pr.var = cars_prcomp$sdev^2 
pr.var
```
```{r}
# proportion of variance explained
pve = pr.var/sum(pr.var)
pve
```
```{r}
plot(pve, xlab="Principal Component", ylab="Proportion of Variance Explained", ylim=c(0,1), type="b")
```

The scree plot shows an elbow at PC2. By PC2, most of the variance between variables have been explained.
Using the first two principal components, we can plot the data in two dimensions and to visually identify clusters of closely related data points.


```{r}
biplot(cars_prcomp, scale=0, col=c(9,4), cex=0.6, xlim=c(-4.5,4.5)) 
```

The horsepower (hp), displacement of engine's cylinders (disp) and weight (wt) of the cars are positively loaded on first Principal Component, PC1. While miles/gallon (mpg) and rear axle ratio (drat) are negatively loaded on PC1. 
The 1/4 mile time (qsec) is largely negatively loaded on on PC2, close to being parallel to PC2.

From the biplot, the displacement of engine's cylinders (disp) and weight (wt) of the cars are more closely correlated to each other compared to the rest.

Cars such as Honda Civic, Toyota Corolla are more fuel efficient.
Cars such as Lincoln Continental, Cadillac Fleetwood and Chrysler Imperial are more powerful but less fuel efficient.
Cars such as Maserati Bora and Ford Pantera are very fast cars, clustered close together. The Valiant and Merc 230 are slower compared to the rest.


